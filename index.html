<!DOCTYPE html>
<html>

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="reset.css">
  <link rel="stylesheet" href="style.css">
  <title>Browser Adventure</title>
</head>


<body id="gameRoot">

  <p id="welcome">Welcome to Browser Adventure!</p>

  <img id="themeImage" src="img/bar.jpg" alt="Background Image">
  <br />
  
  <script>


//=============== GAME ENGINE ===============//
    const gameState = {
      currentLocation: 'bar',
      beersDrunk: 0
    }

    const UI = {
      setThemeImage: (image) => {
        const imageElement = document.getElementById('themeImage')
        imageElement.setAttribute("src", image)
      },
      setThemeButtons: (actions) => {
        // Clear existing buttons
        const existingButtons = Array.from(document.getElementsByClassName('action-button'))
        existingButtons.forEach(button => button.remove())

        // Find Root
        const bodyElement = document.getElementById("gameRoot")

        // Loop through actions
        actions.forEach(action => {
          const myButton = document.createElement('button')
          myButton.setAttribute("class", "block action-button")
          myButton.innerHTML = action.label
          myButton.addEventListener('click', action.action)
          bodyElement.append(myButton)
        })
      }
    }

    const GameManager = {
      setRoom: (room) => {
        UI.setThemeImage(room.image)
        UI.setThemeButtons(room.actions)
      }
    }


//=============== GAMEPLAY STUFF ===============//
//TODO: Combat/HP system, inventory system, weapons, healing food/potions

    const gameWorld = {
      bar: {
        image: "img/bar.jpg",
        actions: [
          {
            label: 'Drink a Beer',
            action: () => {
              gameState.beersDrunk+=1
              console.log('Drinking beer #' + gameState.beersDrunk)
              if (gameState.beersDrunk > 6){
                console.log("You probably shouldn't drink any more.")
              }
              //TODO: health drain after 10 drinks, death at 15
            }
          },
          {
            label: 'Shout at Man',
            action: () => {
              console.log('Shouting')
            }
          },
          {
            label: 'Look around',
            action: () => {
              console.log("You're at the bar. Go have a drink, mate!")
              //TODO: room examine text
            }
          },
          {
            label: 'Leave',
            action: () => {
              GameManager.setRoom(gameWorld.townsquare)
            }
          }
        ]
      },
      townsquare: {
        image: "img/townsquare.jpg",
        actions: [
          {
            label: 'Go for a drink',
            action: () => {
              GameManager.setRoom(gameWorld.bar)
            }
          },
          {
          label: 'Look around',
            action: () => {
              console.log("You're at the town square.")
              //TODO: room examine text
            }
          },
          {
            label: 'Leave town',
            action: () => {
              GameManager.setRoom(gameWorld.forest)
            }
          },
        ]
      },
      forest: {
        image: "img/forest.jpg",
        actions: [
          {
            label: 'Explore deeper',
            action: () => {
              GameManager.setRoom(gameWorld.deepforest)
            }
          },
          {
          label: 'Look around',
            action: () => {
              console.log("You're in a forest.")
              //TODO: room examine text
            }
          },
          {
            label: 'Enter town',
            action: () => {
              GameManager.setRoom(gameWorld.townsquare)
            }
          }
        ]
      },
      deepforest: {
        image: "img/deepforest.jpg",
        actions: [
          {
            label: 'Explore even deeper...',
            action: () => {
              GameManager.setRoom(gameWorld.deepforest)
              //eaten by grue?
              //death screen here?
            }
          },
          {
          label: 'Look around',
            action: () => {
              console.log("You're in a dark forest.")
              //TODO: room examine text
            }
          },
          {
            label: 'Go back to safety',
            action: () => {
              GameManager.setRoom(gameWorld.forest)
            }
          }
        ]
      }
    }

    function startGame() {
      GameManager.setRoom(gameWorld[gameState.currentLocation])
    }

    document.onload = startGame();

  </script>

  <noscript>Sorry, your browser does not support JavaScript!</noscript>

</body>

</html>